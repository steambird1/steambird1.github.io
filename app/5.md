# C++ 快速入门

## 5.2 结构体与函数

### 结构体

通常情况下，一个信息不像（或很难）只用一个基本的数据类型（数字、字符串……）表达。例如一个学生的姓名和年龄信息。
你也许会说，可以这样写：
```c++
string student_name;
int student_age;
```
同样的，一群学生可以这样写：
```c++
string students_name[100];
int students_age[100];
```
但如果我让你存储的信息多一些，如班级、电话、家庭住址……，或者要求将这些信息作为一个整体，就显得困难了。
试想，如果可以这样，像一个基本类型一样，是不是可以简单许多：
```c++
student s;
```
还真的可以这样，我们可以定义自己的类型（叫 **结构体**）。
定义自己类型的形式如下：
```c++
struct 你的类型名 {
	// 以声明 (如果你忘记了，那么你需要往回看) 的形式列出成员 ...
} 该类型的变量 ;
```
之后，就可以直接像 `student s;` 或者 `student s[100]` 一样声明了。
比如我们把之前的东西简化一下：

```c++
struct student {
	string name;
	int age;
};
```

#### 访问成员
紧接着，改成使用结构体了，但你却发现不知道如何访问或修改成员（比如，给一个学生改名）了。
其实，这很简单，只需要用 `结构体变量.成员名称` 的形式。看，它可以像一个普通变量一样使用：
```c++
// 紧接着上面的 student，下均同
student s, t[100];
s.name = "张三";
cout << s.name << endl;

t[0].name = "李四";
cout << t[0].name << endl;
```

#### 结构体与指针
结构体可以有指针类型，如：
```c++
student *p;
```
但此时，就不能使用形如 `p.name` 的形式了，会出现错误，提示你用 `p->name`（或者 `(*p).name`）。
这时正确的使用是：
```c++
student *p;
p->name = "张三";
cout << p->name << endl;
```

### 函数

#### 函数的定义与声明

这个函数和数学上的函数有点类似，不过可以有多个自变量（叫**参数**），但因变量只能是一个（叫**返回值**）。
函数的定义方式如下：
```c++
// 除了返回类型标识和函数名之间的空格以外，其它空格都是可选的
返回类型 函数名 (以逗号分割、声明形式（结尾不需要分号）写出的参数列表) {
	// 执行部分 ...
}
```
当然，函数也能只声明、不定义。声明的方式就是将上文定义格式的执行部分去除，并在结尾加上语句结尾的 `;`。
**必须确保声明过的函数有定义。**

在函数中，用 `return 值;` 的形式返回值。函数中可以使用任意语句，但函数不能嵌套。
函数之间的变量不能互相访问或修改，但所有函数均可以访问或修改全局变量。

"返回类型"处若为 `void` 则表示该函数没有返回值。
如果有返回值，那么整个函数可以像一个普通的值一样使用（之后会有例子）。
（如果返回类型为 `void`，则**不能再使用 `return 值;` 的方式，只能使用 `return;` 而不跟其它内容。**

参数若为空（即 `()` ）或为 `(void)` 表示没有参数。
要求的参数也可以像普通变量一样在函数体内使用，值即为调用时传递的值。

#### 函数的调用

函数这样调用：
```c++
函数名(要求的参数的值，顺序必须一致并以逗号分割);
```
如果函数有返回值，也可以将函数的调用放入表达式中参与运算。此时则不需要 `;` （毕竟 `;` 只有语句结束才有。）

#### 完整例子

以下为一个函数的例子，输出我们之前给出的学生（`student`）类型和一个给定的数字，返回已经输出的个数：
```c++
#include <iostream>
using namespace std;

int n = 0;

int put_stud(student s, int x) {
	n++;
	cout << x << " " << s.name << " " << s.age << endl;
	return n;
}

int main() {
	student s, t;
	s.name = "AA";
	s.age = 12;
	t.name = "BB";
	t.age = 13;
	int x = put_stud(s, 0) + 1;	// x = 2
	cout << put_stud(t, 5) << endl << x << endl;
	return 0;
}
```
输出应该是：
```
0 AA 12
5 BB 13
2
2
```

-----

还记得我们开始时的 `int main()` 吗？
你可以说出它的返回值类型与参数吗？

#### 使用函数的好处
使用函数有很多好处。比如，你有一个 100 行的内容需要反复调用，如果写进函数里，就可以省不少时间。
同时，函数也可以调用自己，形成“递归”（这个以后再讲），解决很多问题。

#### 函数与指针

##### 修改传入参数

刚才我们看到了函数。如果我们需要写一个交换两个变量的值的函数，输入两个 `int` 型变量，交换它们的值，该怎么写呢？
我们先尝试这样：
```c++
#include <iostream>
using namespace std;

void f(int x, int y) {
	int t = x;
	x = y;
	y = t;
}

int main() {
	int a = 3, b = 5;
	f(a,b);
	cout << a << b << endl;
	return 0;
}
```
输出结果应该是：`3 5`。
怎么回事？根本没有被交换啊！
其实，在传递函数参数的过程中，参数被**拷贝**了一份，内外是没有影响的。也就是说，刚刚这个代码被”带入“进去是这样的：
```c++
#include <iostream>
using namespace std;

int main() {
	int a = 3, b = 5;
	// f(a,b);
	int f_a = a, f_b = b;
	int t = f_a;
	f_a = f_b;
	f_b = t;
	// 结束
	cout << a << b << endl;
	return 0;
}
```
这时，**指针**就上场了。它可以直接让你”精准打击“到 `a` 和 `b` 真正存放的位置，交换它们的值，这又该怎么写呢？（可以自己想想）

-----

本期内容就到这里。
之后，可以做做这里的题目：
[洛谷的”结构体与函数“题单](https://www.luogu.com.cn/training/105#problems)

下期预告：
> 5.3 递归与文件操作
> 6 C (`char*`) 与 C++ (`string`) 的字符串操作